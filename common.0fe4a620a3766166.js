"use strict";(self.webpackChunkfood_meter=self.webpackChunkfood_meter||[]).push([[592],{748:(v,h,i)=>{i.d(h,{R:()=>t});var r=i(1135),l=i(7579),d=i(4650);let t=(()=>{class c{constructor(){this.ingredients=[],this.total=new r.X({name:"TOTAL:",actualWeight:0,ccal:0,protein:0,carbon:0,fat:0}),this.ingredientsChange=new l.x}addIngredient(n){this.ingredients.push(this.transformIntoIngrForCalc(n,this.ingredients.length,null)),this.ingredientsChange.next(this.ingredients),this.changeTotalData(this.ingredients)}addIngredients(n){let a=this.ingredients.length;n.forEach(e=>{this.ingredients.push(this.transformIntoIngrForCalc(e,a,null)),a++}),this.ingredientsChange.next(this.ingredients),this.changeTotalData(this.ingredients)}updateIngredientsPer100Info(n,a){const e=a.map(o=>o.id===n.id?{...o,ccalPer100:n.ccal,proteinPer100:n.protein,carbonPer100:n.carbon,fatPer100:n.fat}:o);this.ingredients=e,this.changeAllIngredientsData(this.ingredients)}changeIngredientData(n){const a=this.ingredients.findIndex(e=>e.id===n.id&&e.index===n.index);-1!==a&&(this.ingredients[a]={...n,ccal:+(n.ccalPer100*n.actualWeight/100).toFixed(2),protein:+(n.proteinPer100*n.actualWeight/100).toFixed(2),carbon:+(n.carbonPer100*n.actualWeight/100).toFixed(2),fat:+(n.fatPer100*n.actualWeight/100).toFixed(2)},this.ingredientsChange.next(this.ingredients),this.changeTotalData(this.ingredients))}changeAllIngredientsData(n){const a=n.map(e=>({...e,ccal:+(e.ccalPer100*e.actualWeight/100).toFixed(2),protein:+(e.proteinPer100*e.actualWeight/100).toFixed(2),carbon:+(e.carbonPer100*e.actualWeight/100).toFixed(2),fat:+(e.fatPer100*e.actualWeight/100).toFixed(2)}));this.ingredients=a,this.ingredientsChange.next(this.ingredients),this.changeTotalData(this.ingredients)}deleteIngr(n){const a=this.ingredients.findIndex(e=>e.name===n.name);this.ingredients.splice(a,1),this.ingredientsChange.next(this.ingredients),this.changeTotalData(this.ingredients)}deleteAllIngr(){this.ingredients=[],this.ingredientsChange.next(this.ingredients),this.changeTotalData(this.ingredients)}changeTotalData(n){this.total.next(n.reduce((a,e)=>({name:"TOTAL:",actualWeight:+(a.actualWeight+e.actualWeight).toFixed(2),ccal:+(a.ccal+e.ccal).toFixed(2),protein:+(a.protein+e.protein).toFixed(2),carbon:+(a.carbon+e.carbon).toFixed(2),fat:+(a.fat+e.fat).toFixed(2)}),{name:"TOTAL:",actualWeight:0,ccal:0,protein:0,carbon:0,fat:0}))}transformIntoIngrForCalc(n,a,e){const o=e||100;return{index:a,name:n.name,id:n.id,authorID:n.authorID,gram:n.gram,actualWeight:o,ccal:+(n.ccal*o/100).toFixed(2),ccalPer100:n.ccal,protein:+(n.protein*o/100).toFixed(2),proteinPer100:n.protein,carbon:+(n.carbon*o/100).toFixed(2),carbonPer100:n.carbon,fat:+(n.fat*o/100).toFixed(2),fatPer100:n.fat}}}return c.\u0275fac=function(n){return new(n||c)},c.\u0275prov=d.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},4926:(v,h,i)=>{i.d(h,{M:()=>_});var r=i(7579),l=i(1135),d=i(4650),t=i(748),c=i(5599);let _=(()=>{class n{constructor(e,o){this._calculatorService=e,this._authService=o,this._ingredients=[],this.isIngredientChange=new r.x,this.isEditMode=new l.X(!1),this.isEditIngr=new r.x}get ingredients(){return JSON.parse(JSON.stringify(this._ingredients))}setIngredients(e){this._ingredients=e,this.isIngredientChange.next(this.ingredients)}editIngredient(e){this.isEditMode.next(!0),this.isEditIngr.next(e)}addIngredient(e){const o={...e,authorID:this._authService.user.getValue().id};this._ingredients.push(o),this.isIngredientChange.next(this.ingredients)}saveChangedIngredient(e){this.isEditMode.next(!1),this.isEditIngr.next(null);const o=this._ingredients.findIndex(s=>s.id===e.id);if(-1!==o){const s=this.fixedValueInIngr(e);this._ingredients[o]=s,this.isIngredientChange.next(this.ingredients),this._calculatorService.updateIngredientsPer100Info(s,this._calculatorService.ingredients)}}cancelChangedIngredient(){this.isEditMode.next(!1),this.isEditIngr.next(null),this.isIngredientChange.next(this.ingredients)}deleteIngredient(e){const o=this._ingredients.findIndex(s=>s.id===e.id);this._ingredients.splice(o,1),this.isIngredientChange.next(this.ingredients)}fixedValueInIngr(e){const o=e.id?e.id:null,s=e.authorID?e.authorID:null;return{name:e.name,gram:e.gram,ccal:+e.ccal.toFixed(2),protein:+e.protein.toFixed(2),carbon:+e.carbon.toFixed(2),fat:+e.fat.toFixed(2),id:o,authorID:s}}}return n.\u0275fac=function(e){return new(e||n)(d.LFG(t.R),d.LFG(c.e))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},3327:(v,h,i)=>{i.d(h,{q:()=>a});var r=i(4004),l=i(8505),d=i(4650),t=i(529),c=i(4926),_=i(748),n=i(5599);let a=(()=>{class e{constructor(s,u,f,E){this._http=s,this._ingredientsService=u,this._calculatorService=f,this._authService=E}fetchIngredients(){const s=this._authService.user.getValue().id;return this._http.get(`https://food-meter-d7f59-default-rtdb.firebaseio.com/ingredients/user/${s}.json`).pipe((0,r.U)(u=>{const f=[];for(let E in u)u.hasOwnProperty(E)&&u[E].authorID===s&&f.push({...u[E]});return f}),(0,l.b)(u=>{u&&this._ingredientsService.setIngredients(u)}))}storeIngredients(){const s=this._ingredientsService.ingredients,u=this._authService.user.getValue().id;this._http.put(`https://food-meter-d7f59-default-rtdb.firebaseio.com/ingredients/user/${u}.json`,s).subscribe(f=>{})}}return e.\u0275fac=function(s){return new(s||e)(d.LFG(t.eN),d.LFG(c.M),d.LFG(_.R),d.LFG(n.e))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},5805:(v,h,i)=>{i.d(h,{k:()=>C});var r=i(4006),l=i(5412),d=i(7787),t=i(4650),c=i(4926),_=i(3327),n=i(748),a=i(5599),e=i(6895),o=i(4859),s=i(9549),u=i(4144),f=i(6709);function E(I,P){if(1&I&&(t.TgZ(0,"mat-checkbox",15),t._uU(1,"Add to My ingredients"),t.qZA()),2&I){const g=t.oxw();t.Q6J("formControl",g.addIngr)}}const D=function(){return{color:"#673ab7"}};let C=(()=>{class I{constructor(g,m,p,O,M,x){this._ingrService=g,this._ingrStoreService=m,this._calculatorService=p,this._authService=O,this.dialogRef=M,this.data=x,this.addIngr=new r.NI("true",[r.kI.required])}ngOnInit(){this._formInitialization()}onNoClick(){this.dialogRef.close()}handleSaveIngredient(){const g={name:this.form.controls.name.value,gram:this.form.controls.gram.value,ccal:+Number(this.form.controls.ccal.value).toFixed(2),protein:+Number(this.form.controls.protein.value).toFixed(2),carbon:+Number(this.form.controls.carbon.value).toFixed(2),fat:+Number(this.form.controls.fat.value).toFixed(2),id:(0,d.O)(),authorID:null};this.data.calculator&&this._calculatorService.addIngredient(g),this.addIngr.value&&this._authService.user.getValue()&&(this._ingrService.addIngredient(g),this._ingrStoreService.storeIngredients())}_formInitialization(){this.form=new r.cw({name:new r.NI("",r.kI.required),gram:new r.NI("100",[r.kI.required]),ccal:new r.NI("",[r.kI.required]),protein:new r.NI("",[r.kI.required]),carbon:new r.NI("",[r.kI.required]),fat:new r.NI("",[r.kI.required])})}}return I.\u0275fac=function(g){return new(g||I)(t.Y36(c.M),t.Y36(_.q),t.Y36(n.R),t.Y36(a.e),t.Y36(l.so),t.Y36(l.WI))},I.\u0275cmp=t.Xpm({type:I,selectors:[["app-new-ingredient"]],decls:47,vars:7,consts:[["mat-dialog-title",""],[3,"ngStyle"],["mat-dialog-content",""],[3,"formGroup"],["appearance","outline"],["matInput","","formControlName","name"],["matInput","","value","100","readonly","true","formControlName","gram",3,"disabled"],["matInput","","type","number","min","0","step","0.1","formControlName","ccal"],["type","number","min","0","matInput","","step","0.1","formControlName","protein"],["matInput","","type","number","min","0","step","0.1","formControlName","carbon"],["matInput","","type","number","min","0","step","0.1","formControlName","fat"],[3,"formControl",4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","type","button","cdkFocusInitial","",3,"mat-dialog-close","disabled","click"],[3,"formControl"]],template:function(g,m){1&g&&(t.TgZ(0,"h1",0),t._uU(1,"New ingredient"),t.qZA(),t.TgZ(2,"p"),t._uU(3,"Add information "),t.TgZ(4,"b",1),t._uU(5,"per 100 gram"),t.qZA(),t._uU(6,">"),t.qZA(),t.TgZ(7,"div",2)(8,"form",3)(9,"mat-form-field",4)(10,"mat-label"),t._uU(11,"Name"),t.qZA(),t._UZ(12,"input",5),t.qZA(),t.TgZ(13,"mat-form-field",4)(14,"mat-label"),t._uU(15,"Gram"),t.qZA(),t._UZ(16,"input",6),t.qZA(),t.TgZ(17,"mat-form-field",4)(18,"mat-label"),t._uU(19,"Ccal"),t.qZA(),t._UZ(20,"input",7),t.TgZ(21,"mat-error"),t._uU(22,"Only numbers"),t.qZA()(),t.TgZ(23,"mat-form-field",4)(24,"mat-label"),t._uU(25,"Protein"),t.qZA(),t._UZ(26,"input",8),t.TgZ(27,"mat-error"),t._uU(28,"Only numbers"),t.qZA()(),t.TgZ(29,"mat-form-field",4)(30,"mat-label"),t._uU(31,"Carbon"),t.qZA(),t._UZ(32,"input",9),t.TgZ(33,"mat-error"),t._uU(34,"Only numbers"),t.qZA()(),t.TgZ(35,"mat-form-field",4)(36,"mat-label"),t._uU(37,"Fat"),t.qZA(),t._UZ(38,"input",10),t.TgZ(39,"mat-error"),t._uU(40,"Only numbers"),t.qZA()(),t.YNc(41,E,2,1,"mat-checkbox",11),t.qZA()(),t.TgZ(42,"div",12)(43,"button",13),t.NdJ("click",function(){return m.onNoClick()}),t._uU(44,"Cancel"),t.qZA(),t.TgZ(45,"button",14),t.NdJ("click",function(){return m.handleSaveIngredient()}),t._uU(46," Save "),t.qZA()()),2&g&&(t.xp6(4),t.Q6J("ngStyle",t.DdM(6,D)),t.xp6(4),t.Q6J("formGroup",m.form),t.xp6(8),t.Q6J("disabled",!0),t.xp6(25),t.Q6J("ngIf",m.data.checkbox&&m.data.isAuth),t.xp6(4),t.Q6J("mat-dialog-close",m.data)("disabled",!m.form.valid))},dependencies:[e.O5,e.PC,o.lW,s.TO,s.KE,s.hX,u.Nt,l.ZT,l.uh,l.xY,l.H8,f.oG,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.qQ,r.oH,r.sg,r.u]}),I})()},1120:(v,h,i)=>{i.d(h,{a:()=>c});var r=i(6895),l=i(4006),d=i(3806),t=i(4650);let c=(()=>{class _{}return _.\u0275fac=function(a){return new(a||_)},_.\u0275mod=t.oAB({type:_}),_.\u0275inj=t.cJS({imports:[r.ez,d.q,l.UX,d.q]}),_})()},7787:(v,h,i)=>{function r(d){const t=d.which?d.which:d.keyCode;return!(t>31&&(t<48||t>57))}function l(){return String(Date.now().toString(32)+Math.random().toString(16)).replace(/\./g,"")}i.d(h,{H:()=>r,O:()=>l})}}]);